---
title: hibernate创建过程以及ORA自增、generator生成策略概览
tags:
  - hibernate 5
  - Oracle 12c
categories: hibernate
keywords: 'hibernate,oracle12c'
copyright: true
abbrlink: 2e4e91b5
date: 2018-03-07 19:54:59
---
#### idea创建hibernate过程概览
*熟悉的可略过，不了解此过程的，建议百度其他博客图文*
__`[√] hibernate`可选需求项，忽略__
__`use library`选择`/hibernate/lib/required`目录的所有jar包__
```
├─envers
├─jpa-metamodel-generator
├─optional
│  ├─c3p0
│  ├─ehcache
│  ├─infinispan
│  └─proxool
├─osgi
├─required
└─spatial
```
<!--more-->
__`dependencies`->`+`->所选必要jar包，例如：`ojdbc7.jar`__
__创建pojo对象并序列化（实现Serializable接口）__
__`Database`->`oracle`->`general`填入必要值__
__`persistence`->右击模块名->`general persistence mapping`->`by database schema`__
__package填入pojo对象所在的包，[√]相应的表文件，`generation settings`默认__
__`.hbm.xml`文件必须指定`type`属性类型，`hibernate.cfg.xml`写入必要参数__

#### oracle自增长方式
* Oracle12C
sql语句
```sql
create table T(
    -- 允许手工指定自增字段值，只要不重复即可
    -- generated by default on null as identity

    --always不允许指定，只能由数据库分配值
    id number generated always as identity primary key,
    name varchar2(70),
    email varchar2(80),
    hiredate date
)
```
* Oracle12C之前版本
  创建序列
```sql
create sequence t_seq
start with 1
increment by 1
nomaxvalue 
nocache --不缓存
nocycle -- 不循环
```
  插入
```sql
insert into T(主键名,xxx,xxx,xxx)values(序列名.nextval,xxx,xxx,xxx)
```

>cache的作用：
当大量语句发生请求，申请序列时，为了避免序列在运用层实现序列而引起的性能瓶颈。Oracle序列允许将序列提前生成 cache x个先存入内存，在发生大量申请序列语句时，可直接到运行最快的内存中去得到序列。但cache个数也不能设置太大，因为在数据库重启时，会清空内存信息，预存在内存中的序列会丢失，当数据库再次启动后，序列从上次内存中最大的序列号+1 开始存入cache x个
cycle循环使用：
到达最大值或者最小值时，从新建立对象
摘自：https://zhidao.baidu.com/question/319404522.html

#### generator节点最为常用的自增策略
在`.hbm.xml`文件中id标签内添加generator节点自增策略配置方式
* identity
```xml
<!-- oracle12c可用，需用identity建表 -->
<generator class="identity" />
```
* increment (极不推荐集群环境下使用)
```xml
<!-- oracle可用 ，不需要sequence，也不需要identity-->
<generator class="increment" />
```
* sequence
```xml
<!-- 需要存在的序列，5版本中由param的属性值由sequence换成了sequence_name -->
<generator class="sequence">
<param name="sequence_name">xxx_seq</param>
</generator>
```